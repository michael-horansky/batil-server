-- MySQL Script generated by MySQL Workbench
-- Thu 14 Aug 2025 09:43:37 BST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

PRAGMA foreign_keys = ON;

-- -----------------------------------------------------
-- Table `BOC_USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_USER` ;

CREATE TABLE IF NOT EXISTS `BOC_USER` (
  `USER_ID` VARCHAR(32) NOT NULL,
  `FNAME` VARCHAR(64) NULL DEFAULT NULL,
  `LNAME` VARCHAR(64) NOT NULL,
  `EMAIL` VARCHAR(128) NULL DEFAULT NULL,
  `PASSWORD` VARCHAR(32) NOT NULL,
  `AUTH_CODE` VARCHAR(128) NULL DEFAULT NULL,
  `N_FAILS` INTEGER NULL DEFAULT 0,
  `D_CREATED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `D_CHANGED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `D_LOCKED` DATETIME NULL DEFAULT NULL,
  `PRIVILEGE` VARCHAR(32) NOT NULL DEFAULT 'USER',
  PRIMARY KEY (`USER_ID`));


-- -----------------------------------------------------
-- Table `BOC_BOARDS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_BOARDS` ;

CREATE TABLE IF NOT EXISTS `BOC_BOARDS` (
  `BOARD_ID` VARCHAR(45) NOT NULL,
  `T_DIM` INT NULL,
  `X_DIM` INT NULL,
  `Y_DIM` INT NULL,
  `STATIC_REPRESENTATION` VARCHAR(1023) NULL,
  `SETUP_REPRESENTATION` VARCHAR(1023) NULL,
  `AUTHOR` VARCHAR(32) NOT NULL,
  `IS_PUBLIC` INTEGER NULL,
  `D_CREATED` DATETIME NULL,
  `D_CHANGED` DATETIME NULL,
  `D_PUBLISHED` DATETIME NULL,
  `HANDICAP` REAL NULL,
  `BOARD_NAME` VARCHAR(45) NULL,
  PRIMARY KEY (`BOARD_ID`),
  INDEX `fk_BOC_BOARDS_PM_USER1_idx` (`AUTHOR` ASC),
  CONSTRAINT `fk_BOC_BOARDS_PM_USER1`
    FOREIGN KEY (`AUTHOR`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_GAMES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_GAMES` ;

CREATE TABLE IF NOT EXISTS `BOC_GAMES` (
  `GAME_ID` VARCHAR(32) NOT NULL,
  `PLAYER_A` VARCHAR(32) NOT NULL,
  `PLAYER_B` VARCHAR(32) NOT NULL,
  `BOARD_ID` VARCHAR(32) NULL,
  `D_CHALLENGE` DATETIME NULL,
  `D_STARTED` DATETIME NULL,
  `D_FINISHED` DATETIME NULL,
  `STATUS` VARCHAR(45) NULL,
  `DRAW_OFFER_STATUS` VARCHAR(45) NULL DEFAULT 'no_offer',
  `OUTCOME` VARCHAR(45) NULL,
  `PLAYER_A_PROMPTED` DATETIME NULL DEFAULT NULL,
  `PLAYER_B_PROMPTED` DATETIME NULL DEFAULT NULL,
  `PLAYER_A_DEADLINE` DATETIME NULL DEFAULT NULL,
  `PLAYER_B_DEADLINE` DATETIME NULL DEFAULT NULL,
  `PLAYER_A_CUMULATIVE_SECONDS` INT NULL DEFAULT 0,
  `PLAYER_B_CUMULATIVE_SECONDS` INT NULL DEFAULT 0,
  PRIMARY KEY (`GAME_ID`),
  INDEX `fk_BOC_GAMES_PM_USER_idx` (`PLAYER_A` ASC),
  INDEX `fk_BOC_GAMES_PM_USER1_idx` (`PLAYER_B` ASC),
  INDEX `fk_BOC_GAMES_BOC_BOARDS1_idx` (`BOARD_ID` ASC),
  CONSTRAINT `fk_BOC_GAMES_PM_USER`
    FOREIGN KEY (`PLAYER_A`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION,
  CONSTRAINT `fk_BOC_GAMES_PM_USER1`
    FOREIGN KEY (`PLAYER_B`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION,
  CONSTRAINT `fk_BOC_GAMES_BOC_BOARDS1`
    FOREIGN KEY (`BOARD_ID`)
    REFERENCES `BOC_BOARDS` (`BOARD_ID`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_USER_RELATIONSHIPS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_USER_RELATIONSHIPS` ;

CREATE TABLE IF NOT EXISTS `BOC_USER_RELATIONSHIPS` (
  `USER_1` VARCHAR(32) NOT NULL,
  `USER_2` VARCHAR(32) NOT NULL,
  `STATUS` VARCHAR(45) NULL,
  PRIMARY KEY (`USER_1`, `USER_2`),
  INDEX `fk_BOC_USER_RELATIONSHIPS_PM_USER2_idx` (`USER_2` ASC),
  CONSTRAINT `fk_BOC_USER_RELATIONSHIPS_PM_USER1`
    FOREIGN KEY (`USER_1`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION,
  CONSTRAINT `fk_BOC_USER_RELATIONSHIPS_PM_USER2`
    FOREIGN KEY (`USER_2`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_RULEGROUPS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_RULEGROUPS` ;

CREATE TABLE IF NOT EXISTS `BOC_RULEGROUPS` (
  `RULE_GROUP` VARCHAR(32) NOT NULL,
  `DESCRIPTION` VARCHAR(1023) NULL,
  `ORDER` INT NULL,
  PRIMARY KEY (`RULE_GROUP`))


-- -----------------------------------------------------
-- Table `BOC_RULES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_RULES` ;

CREATE TABLE IF NOT EXISTS `BOC_RULES` (
  `RULE` VARCHAR(32) NOT NULL,
  `RULE_GROUP` VARCHAR(32) NOT NULL,
  `DESCRIPTION` VARCHAR(1023) NULL,
  `ORDER` INT NULL,
  `RESTRICTION` VARCHAR(16) NULL,
  `REQUIREMENT` VARCHAR(16) NULL,
  `LABEL` VARCHAR(45) NULL,
  PRIMARY KEY (`RULE`),
  CONSTRAINT `fk_BOC_RULES_BOC_RULEGROUPS1`
    FOREIGN KEY (`RULE_GROUP`)
    REFERENCES `BOC_RULEGROUPS` (`RULE_GROUP`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_MOVES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_MOVES` ;

CREATE TABLE IF NOT EXISTS `BOC_MOVES` (
  `GAME_ID` VARCHAR(32) NOT NULL,
  `TURN_INDEX` INT NOT NULL DEFAULT 0,
  `PLAYER` VARCHAR(7) NOT NULL,
  `REPRESENTATION` VARCHAR(1023) NULL,
  `D_MOVE` DATETIME NULL,
  PRIMARY KEY (`GAME_ID`, `TURN_INDEX`, `PLAYER`),
  CONSTRAINT `fk_BOC_MOVES_BOC_GAMES1`
    FOREIGN KEY (`GAME_ID`)
    REFERENCES `BOC_GAMES` (`GAME_ID`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_RULESETS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_RULESETS` ;

CREATE TABLE IF NOT EXISTS `BOC_RULESETS` (
  `GAME_ID` VARCHAR(32) NOT NULL,
  `RULE_GROUP` VARCHAR(32) NOT NULL,
  `RULE` VARCHAR(32) NULL,
  PRIMARY KEY (`GAME_ID`, `RULE_GROUP`),
  INDEX `fk_BOC_RULESETS_BOC_RULEGROUPS1_idx` (`RULE_GROUP` ASC),
  INDEX `fk_BOC_RULESETS_BOC_RULES1_idx` (`RULE` ASC),
  CONSTRAINT `fk_BOC_RULESETS_BOC_GAMES1`
    FOREIGN KEY (`GAME_ID`)
    REFERENCES `BOC_GAMES` (`GAME_ID`)
    ON DELETE NO ACTION,
  CONSTRAINT `fk_BOC_RULESETS_BOC_RULEGROUPS1`
    FOREIGN KEY (`RULE_GROUP`)
    REFERENCES `BOC_RULEGROUPS` (`RULE_GROUP`)
    ON DELETE NO ACTION,
  CONSTRAINT `fk_BOC_RULESETS_BOC_RULES1`
    FOREIGN KEY (`RULE`)
    REFERENCES `BOC_RULES` (`RULE`)
    ON DELETE NO ACTION)


-- -----------------------------------------------------
-- Table `BOC_USER_RATING`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `BOC_USER_RATING` ;

CREATE TABLE IF NOT EXISTS `BOC_USER_RATING` (
  `PM_USER_ID` VARCHAR(32) NOT NULL,
  `RATING_TYPE` VARCHAR(45) NOT NULL,
  `RATING_VALUE` INT NULL,
  PRIMARY KEY (`PM_USER_ID`, `RATING_TYPE`),
  CONSTRAINT `fk_BOC_USER_RATING_PM_USER1`
    FOREIGN KEY (`PM_USER_ID`)
    REFERENCES `BOC_USER` (`USER_ID`)
    ON DELETE NO ACTION)

